const { sql, getConnection } = require("../config/RapidoSeguro");

const clienteModel = {

    inserirCliente: async (nomeCliente, cpfCliente, telefone, email, endereco) => {
        try {
            const pool = await getConnection();

            let querysql = `INSERT INTO Clientes(idCliente, nomeCliente, cpfCliente, telefone, email, endereco) VALUES(@idCliente @nomeCliente, @cpfCliente, @telefone, @email, @endereco)`;

            //insere o cliente pelo ID, nome, CPF, telefone, email e endereço, usando o VARCHAR para ter uma quantidade definida de caracteres e CHAR para conter apenas números
            await pool.request()
                .input('idCliente', sql.UniqueIdentifier, idCliente)
                .input('nomeCliente', sql.VarChar(40), nomeCliente)
                .input('cpfCliente', sql.CHAR(14), cpfCliente)
                .input('telefone', sql.VARCHAR(12), telefone)
                .input('email', sql.VARCHAR(100), email)
                .input('endereco', sql.VARCHAR(250), endereco)
                .query(querysql);
        } catch (error) {
            console.error(`Erro ao inserir cliente`, error);
            throw error;
        }
    },

    // busca o CPF do cliente para ver se já não esta cadastrado
    buscarCpf: async (cpfCliente) => {
        try {
            const pool = await getConnection();

            let querySQL = "SELECT * FROM"

            const result = await pool
                .request()
                .input(`cpfCliente`, sql.CHAR(14), cpfCliente)
                .query(querySQL)
        } catch (error) {
            console.log(`Erro: O CPF já foi cadastrado`, error);
            throw error;
        }
    },

    // busca um cliente entre aos outros por meio do ID do cliente
    buscarUm: async (idCliente) => {
        try {
            const pool = await getConnection();

            const querySQL = "SELECT * FROM clientes WHERE idCliente = @idCliente"

            const result = await pool
                .request()
                .input(`idCliente`, sql.UniqueIdentifier, idCliente)
                .query(querySQL);

            return result.recordset; // organiza tudo em uma lista ou tabela temporária para organizar os dados

        } catch (error) {
            console.error(`Erro ao buscar cliente`, error);
            throw error;
        }
    },
}
module.exports = { clienteModel };